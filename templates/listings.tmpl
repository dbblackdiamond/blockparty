<!doctype html>
<html>
    <head>
    <link href="/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="/css/blockparty.css" rel="stylesheet"/>
    <script type="text/javascript" src="/js/web3.js"></script>
    <script type="text/javascript" src="/js/jquery.min.js"></script>
    <script type="text/javascript" src="/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/js/d3.min.js"></script>
    <script type="text/javascript" src="/js/blockparty.js"></script>
    <title>BlockParty</title>
    <script language="javascript">
	function initialize() {
	var houses={{.Data}};

	var listings=d3.select("#houses").selectAll("div").data(houses);

	houseDiv=listings.enter()
		.append("div")
			.attr("class","col-md-3")
			.append("div")
			.attr("class",function(d){if (d.status == 'sold') {return "panel panel-default";} else { return "panel panel-success";}});


	houseDivHeading=houseDiv
			.append("div")
			.attr("class","panel-heading")
	houseDivHeading
		.append("h3")
			.attr("class","panel-title")
			.text(function(d){return d.name;})

	var houseDivContent= houseDiv.append("div")
		.attr("class","panel-body")
		.append("a")
			.attr("onClick",function(d){return "showDetails('"+d.contract+"');"});

	houseDivContent
		.append("span")
			.attr("style",function(d){if (d.status == 'sold') {return "visibility:hidden";} else { return "visibility:visible; ";}})
			.attr("class","label label-success")
			.text("For Sale!");
	houseDivContent
		.append("img")
		.attr("src", function(d){return "images/" + d.image;})
		.attr("class","houseImage center-block");
	
	houseDivContent
		.append("div")
		.attr("class","text-center")
		.text(function(d){return d.description;})

	houseDivContent
		.append("div")
		.attr("class","text-center")
		.text(function(d){return '$' + d.price.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g, '$1,');});

	houseDivContent
		.append("div")
			.append("input")
				.attr("type","button")
				.attr("class","btn btn-primary center-block")
				.attr("value","View Listing")
				.attr("onClick",function(d){return "showDetails('"+d.contract+"');"});
	listings.exit().remove();
	}

    function showDetails(contract) {
	    window.location="/details/" + contract
    }
    </script>
    </head>
    <body>
	<nav class="navbar navbar-inverse">
		<div class="container-fluid">
			<div class="navbar-header">
				<a class="navbar-brand" href="#"><span class="glyphicon glyphicon-home"></span> BlockParty</a>
			</div>
		  </div>
	</nav>	    
	<img alt="Pathfinder Logo" class="center-block" src="images/Pathfinder-Logo.png"/>
	<div id="listings" class="container-fluid">
		<div id="houses" class="row"></div>
	</div>
    </body>
    <script language="javascript">
	initialize();
    </script>
</html>
